source("../mission_control/map.r")
source("../mission_control/shortcuts.r")
source("../mission_control/define_cohorts.r")

glow_ids <- c("GLOW01020001","GLOW01020002","GLOW01020003","GLOW01020004","GLOW01020005","GLOW01020006","GLOW01020007","GLOW01020008","GLOW01020009","GLOW01020010","GLOW01020011","GLOW01020012","GLOW01020013","GLOW01020014","GLOW01020015","GLOW01020016","GLOW01060001","GLOW01060002","GLOW01060003","GLOW01070001","GLOW01070002","GLOW01070003","GLOW01070004","GLOW01080001","GLOW01080002","GLOW01080003","GLOW01080004","GLOW01090001","GLOW01090002","GLOW01090003","GLOW01090004","GLOW01090005","GLOW01090006","GLOW01090007","GLOW01090008","GLOW01090009","GLOW01100001","GLOW01100002","GLOW01100003","GLOW01100004","GLOW01100005","GLOW01100006","GLOW01100007","GLOW01100008","GLOW01100009","GLOW01100010","GLOW01100011","GLOW01200001","GLOW01200002","GLOW01200003","GLOW01200004","GLOW01200005","GLOW01340001","GLOW01340002","GLOW01340003","GLOW01340004","GLOW01340005","GLOW01340006","GLOW01340007","GLOW01340008","GLOW01340009","GLOW01340010","GLOW01440001","GLOW01440002","GLOW01440003","GLOW01440004","GLOW01440005","GLOW01440006","GLOW01440007","GLOW01440008","GLOW01440009","GLOW01440010","GLOW01440011","GLOW01440012","GLOW01440013","GLOW01440014","GLOW01440015","GLOW01440016","GLOW01440017","GLOW01440018","GLOW01440019","GLOW01440020","GLOW01440021","GLOW01440022","GLOW01440023","GLOW01440024","GLOW01440025","GLOW01440026","GLOW01440027","GLOW01440028","GLOW01440029","GLOW01440030","GLOW01440031","GLOW01440032","GLOW01440033","GLOW01440034","GLOW01440035","GLOW01440036","GLOW01440037","GLOW01440038")

glow <- 
q( "execute_sql_on_prod 'select * FROM hmfpatients.clinical_summary'" ) %>% 
 fi( patientId %in% glow_ids,  purpleQC != "FAIL_NO_TUMOR" ) %>% 
 pu( sampleId )

non_glow <- 
q("execute_sql_on_prod 'select * from hmfpatients.datarequest_all'") %>% 
 fi(cohortId != "GLOW", !cohortId %in% glow) %>% 
 pu(sampleId)

cohorts <- 
list(
"glow" = 
 define_cohort(
 cohort = "GLOW", primaryTumorLocation = "Brain", acronym = "GBM", name = "Glioblastoma Multiforme",
 test_samples = glow, base_samples = non_glow
 )
)

save_cohorts("request_glow")
